geom_boxplot() +
labs(x = "Stays in Weekend Nights",
title = "Figure 8: Stays in Weekend Nights Boxplot")
hotels %>%
ggplot(aes(stays_in_week_nights)) +
geom_boxplot() +
labs(x = "Stays in Week Nights",
title = "Figure 9: Stays in Week Nights Boxplot")
hotels %>%
mutate(reserved_room_type = as.factor(reserved_room_type)) -> hotels
hotels %>%
mutate(meal = case_when(meal == "Undefined" ~ "No Meal Plan",
meal == "SC" ~ "No Meal Plan",
meal == "BB" ~ "Bed and Breakfast",
meal == "HB" ~ "Half Board",
meal == "FB" ~ "Full Board")
) %>%
mutate(meal = as.factor(meal)) -> hotels
#chuyển về dạng factor
hotels %>%
mutate(hotel = as.factor(hotel)) -> hotels
hotels %>%
filter(market_segment != "Undefined") %>%
mutate(market_segment = as.factor(market_segment)) -> hotels
hotels %>%
filter(distribution_channel != "Undefined") %>%
mutate(distribution_channel = as.factor(distribution_channel)) -> hotels
hotels %>%
mutate(deposit_type = as.factor(deposit_type)) -> hotels
hotels %>%
mutate(agent = na_if(agent, "NULL")) %>%
mutate(agent = as.numeric(agent)) -> hotels
hotels %>%
mutate(company = na_if(company, "NULL")) %>%
mutate(company = as.numeric(company)) -> hotels
hotels %>%
mutate(customer_type = as.factor(customer_type)) -> hotels
hotels %>%
select(adr) %>%
summary
hotels %>%
filter(adr >= 0) -> hotels
glimpse(hotels)
#Dếm số đặt phòng mỗi tháng
hotels %>%
count(month(arrival_date, label = TRUE, abbr = FALSE)) %>%
kable(format = "pipe",
col.names = c("Arrival Month", "Total Number of Bookings"),
caption = "Table 4: Total Number of Bookings by Month")
hotels %>%
select(adults, children, babies) %>%
summarise(across(.fns = summary)) -> guest_age_summary
tibble(c("Min.", "1st Qu.", "Median", "Mean", "3rd Qu.", "Max."),
guest_age_summary) -> guest_age_summary
guest_age_summary %>%
kable(format = "pipe",
col.names = c("", "Adults", "Children", "Babies"),
caption = "Table 5: Guest Age Demographics")
# 10 quốc gia có số lượng đặt phòng lớn nhất
hotels %>%
count(country) %>%
left_join(y = ISO_3166_1, by = c("country" = "Alpha_3")) %>%
select(country, Name, n) %>%
slice_max(order_by = n, n = 10) %>%
kable(format = "pipe",
col.names = c("Abbr.",
"Country",
"Number of Bookings"),
row.names = TRUE,
caption = "Table 6: Top 10 Countries by Number of Bookings")
#Lập bảng danh mục trạng thái đặt chỗ khác nhau
hotels %>%
count(reservation_status) %>%
kable(format = "pipe",
col.names = c("Reservation Status", "Number of Bookings"),
caption = "Table 7: Number of Bookings by Reservation Status"
)
#Đếm số lần cập nhật trạng thái cuối cùng theo tháng
hotels %>%
count(month(reservation_status_date, label = TRUE, abbr = FALSE)) %>%
kable(format = "pipe",
col.names = c("Month", "Number of Bookings"),
caption = "Table 8: Number of Booking Final Updates by Month")
hotels %>%
select(lead_time, days_in_waiting_list) %>%
summarise(across(.fn = summary)) %>%
mutate(stat_labels = c("Min.", "1st Qu.", "Median", "Mean", "3rd Qu.",
"Max.")
) %>%
select(stat_labels, lead_time, days_in_waiting_list) %>%
kable(format = "pipe",
col.names = c("", "Lead Time", "Days in Waiting List"),
caption = "Table 9: Lead Time and Days in Waiting List Summaries")
#Tạo một bảng tóm tắt cho previous_cancellations và previous_bookings_not_cancelled
hotels %>%
select(previous_cancellations, previous_bookings_not_canceled) %>%
summarise(across(.fn = summary)) %>%
# Đặt tên cho các cột
mutate(stat_labels = c("Min.", "1st Qu.", "Median", "Mean", "3rd Qu.",
"Max.")
) %>%
select(stat_labels,
previous_cancellations,
previous_bookings_not_canceled) %>%
kable(format = "pipe",
col.names = c("",
"Previous Cancellations",
"Previous Bookings not Cancelled"),
caption = "Table 10: Previous Cancellations and Previous Bookings not Cancelled Summary")
hotels %>%
select(stays_in_weekend_nights,
stays_in_week_nights,
required_car_parking_spaces,
total_of_special_requests) %>%
summarise(across(.fn = summary)) %>%
mutate(stat_labels = c("Min.", "1st Qu.", "Median", "Mean", "3rd Qu.",
"Max.")
) %>%
select(stat_labels,
stays_in_weekend_nights,
stays_in_week_nights,
required_car_parking_spaces,
total_of_special_requests) %>%
kable(format = "pipe",
col.names = c("",
"Stays in Weekend Nights",
"Stays in Week Nights",
"Required Parking Spaces",
"Total Special Requests")
)
hotels %>%
# Đếm số lượng loại phòng đã được đặt trước
count(reserved_room_type) %>%
full_join(y = count(hotels, assigned_room_type),
by = c("reserved_room_type" = "assigned_room_type")) %>%
kable(format = "pipe",
col.names = c("Room Type", "Reserved", "Assigned"),
caption = "Table 11: Reserved vs. Assigned Room Type Comparison")
hotels %>%
count(hotel) %>%
kable(format = "pipe",
col.names = c("Hotel Type", "Number of Bookings"),
caption = "Table 12: Number of Bookings by Hotel Type")
hotels %>%
count(market_segment) %>%
# Sắp xếp kết quả giảm dần
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
) %>%
kable(format = "pipe",
col.name = c("Market Segment",
"Number of Bookings",
"Percent of Bookings"),
caption = "Table 13: Bookings by Market Segment")
hotels %>%
count(distribution_channel) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
) %>%
kable(format = "pipe",
col.name = c("Distribution Channel",
"Number of Bookings",
"Percent of Bookings"),
caption = "Table 14: Bookings by Distribution Channel")
hotels %>%
select(booking_changes) %>%
summarise(summary(booking_changes)) -> changes_summary
tibble(c("Min.", "1st Qu.", "Median", "Mean", "3rd Qu.", "Max."),
changes_summary) %>%
kable(format = "pipe",
col.names = c("", ""),
caption = "Table 15: Booking Changes Summary Statistics")
hotels %>%
count(deposit_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
) %>%
kable(format = "pipe",
col.name = c("Deposit Type",
"Number of Bookings",
"Percent of Bookings"),
caption = "Table 16: Bookings by Deposit Type")
count <- hotel %>% count(deposit_type)
count <- hotels %>% count(deposit_type)
ggplot() +
geom_bar(aes(x = count, fill = count )) +
scale_fill_manual(values=c("#1F77B4","#FF7F0E","#FFF"))
count <- hotels %>% count(deposit_type)
ggplot() +
geom_bar(aes(x = count, fill = count ))
count <- hotels %>% count(deposit_type)
count
ggplot() +
geom_bar(aes(x = deposit_type, fill = deposit_type ))
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type ))
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type ))+  coord_flip()
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type )) +
coord_flip() +
labs(x = "",
y = "Number of Bookings",
fill = "Deposit Type",
title = "Bookings by Deposit Type")
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type )) +
coord_flip() +
scale_fill_manual(values=c("#1F77B4","#FF7F0E"))+
labs(x = "",
y = "Number of Bookings",
fill = "Deposit Type",
title = "Bookings by Deposit Type")
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type )) +
coord_flip() +
scale_fill_manual(values=c("#1F77B4","#FF7F0E","#000"))+
labs(x = "",
y = "Number of Bookings",
fill = "Deposit Type",
title = "Bookings by Deposit Type")
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type )) +
coord_flip() +
scale_fill_manual(values=c("#1F77B4","#FF7F0E","#000000"))+
labs(x = "",
y = "Number of Bookings",
fill = "Deposit Type",
title = "Bookings by Deposit Type")
ggplot() +
geom_bar(aes(x = hotels$deposit_type, fill = hotels$deposit_type )) +
coord_flip() +
scale_fill_manual(values=c("#1F77B4","#FF7F0E","#B91657"))+
labs(x = "",
y = "Number of Bookings",
fill = "Deposit Type",
title = "Bookings by Deposit Type")
hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
) %>%
kable(format = "pipe",
col.name = c("Customer Type",
"Number of Bookings",
"Percent of Bookings"),
caption = "Table 17: Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2))
hotels$percent_of_bookings
pie3D(hotels$customer_type, labels = hotel %>% mutate(percent_of_bookings = round(100 * n / sum(n),2)),
main = "Bookings by Customer Type", col = rainbow(length(hotels$customer_type)))
hotels$customer_type
customer_type
hotels$deposit_type
hotel %>% mutate(percent_of_bookings = round(100 * n / sum(n),2))
hotels %>% mutate(percent_of_bookings = round(100 * n / sum(n),2))
pie3D(hotels$customer_type, labels = hotels %>% mutate(percent_of_bookings = round(100 * n / sum(n),2)),
main = "Bookings by Customer Type", col = rainbow(length(hotels$customer_type)))
hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
hotels %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
hotels %>%
mutate(percent_of_bookings = round(100 * count(customer_type) / sum(count(customer_type),
2)
)
hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
hotels %>%
count(customer_type) %>%
)
hotels %>%
count(customer_type)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2))
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(customer_type, labels = percent_of_bookings, main="Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(percent_of_bookings, labels = percent_of_bookings, main="Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(table(percent_of_bookings), labels = percent_of_bookings, main="Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(10, labels = percent_of_bookings, main="Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(c(10,20,30,40), labels = percent_of_bookings, main="Bookings by Customer Type")
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2))
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3S(n, labels= customer_type)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(n, labels= customer_type)
x <- c(10,20,30,40)
pie3D(x)
x <- table(hotels$customer_type)
pie3D(x)
hotels %>%
count(customer_type) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),2)) %>%
pie3D(table(customer_type))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
percent
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(table(percent$customer_type), labels = percent$percent_of_bookings, color = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(table(percent$customer_type), labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(table(hotels$customer_type), labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(table(percent$percent_of_bookings), labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$customer_type, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D")) +
legend("bottomright", percent$customer_type, fill = c("#1F77B4","#FF7F0E","#B91657","#04AA6D") )
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
legend("bottomright", percent$customer_type, fill = c("#1F77B4","#FF7F0E","#B91657","#04AA6D") )
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
legend("bottomright", percent$customer_type, fill = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"), cex = 0.8 )
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D")),
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"),
legend("bottomright", percent$customer_type, fill = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"), cex = 0.8 ))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D")
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie3D(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
legend(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
legend(percent$percent_of_bookings, labels = percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
legend(percent$percent_of_bookings, percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
legend(percent$percent_of_bookings, col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
percent <- hotels %>%
count(customer_type) %>%
arrange(desc(n)) %>%
mutate(percent_of_bookings = round(100 * n / sum(n),
2)
)
pie(percent$percent_of_bookings, labels = percent$percent_of_bookings, main = "Bookings by Customer Type", col = c("#1F77B4","#FF7F0E","#B91657","#04AA6D"))
